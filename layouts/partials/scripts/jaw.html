<!-- JAW 专题交互脚本 -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // 模态框数据
    const modalData = {
        hcp: {
            title: '高冲突人格 (HCP)',
            content: `
                <div class="space-y-4">
                    <p><strong class="text-red-600">核心动机：</strong>规避任何个人责任，将所有问题归咎于他人。</p>
                    <div>
                        <p class="font-semibold mb-2">关键行为指标：</p>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            <li><strong>寻找"指责对象"：</strong>全神贯注于攻击一个目标，通常是亲近的同事或上级。</li>
                            <li><strong>情绪失控：</strong>为小事爆发出强烈的愤怒、哭泣或大喊大叫。</li>
                            <li><strong>非黑即白思维：</strong>无法接受妥协，认为事情必须完全按自己的方式进行。</li>
                            <li><strong>极端行为：</strong>做出90%的人在压力下都不会做的过激行为。</li>
                            <li><strong>拒绝反馈：</strong>无法认识到自身行为的问题，强烈抵制任何批评。</li>
                        </ul>
                    </div>
                    <div class="bg-red-50 p-4 rounded-lg">
                        <p class="text-sm"><strong>识别要点：</strong>如果您的同事经常将问题归咎于特定的人，情绪反应过激，且无法接受任何形式的批评或建议，那么他们很可能具有高冲突人格特征。</p>
                    </div>
                </div>
            `
        },
        aggressor: {
            title: '攻击型沟通者',
            content: `
                <div class="space-y-4">
                    <p><strong class="text-orange-600">核心动机：</strong>控制、支配、赢得每一次交锋。</p>
                    <div>
                        <p class="font-semibold mb-2">关键行为指标：</p>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            <li><strong>命令式语气：</strong>使用高亢、命令式的语调，不允许讨论。</li>
                            <li><strong>贬低他人：</strong>通过讽刺、挖苦来削弱他人的自信心。</li>
                            <li><strong>威胁恐吓：</strong>使用威胁来强迫他人服从。</li>
                            <li><strong>无视感受：</strong>完全不考虑他人的情感和需求。</li>
                            <li><strong>争强好胜：</strong>必须在每次互动中占据上风。</li>
                        </ul>
                    </div>
                    <div class="bg-orange-50 p-4 rounded-lg">
                        <p class="text-sm"><strong>识别要点：</strong>这类人在沟通中总是采用攻击性姿态，试图通过声音大小和威胁来控制局面，很少倾听他人意见。</p>
                    </div>
                </div>
            `
        },
        passive: {
            title: '被动攻击型',
            content: `
                <div class="space-y-4">
                    <p><strong class="text-yellow-600">核心动机：</strong>通过隐蔽的方式表达不满和进行报复。</p>
                    <div>
                        <p class="font-semibold mb-2">关键行为指标：</p>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            <li><strong>言行不一：</strong>表面同意，实际上消极抵制。</li>
                            <li><strong>故意拖延：</strong>通过拖延来表达不满。</li>
                            <li><strong>冷暴力：</strong>使用沉默、冷淡来惩罚他人。</li>
                            <li><strong>间接攻击：</strong>通过第三方或暗示来表达敌意。</li>
                            <li><strong>受害者心态：</strong>总是觉得自己被不公平对待。</li>
                        </ul>
                    </div>
                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <p class="text-sm"><strong>识别要点：</strong>这类人很少直接表达不满，而是通过各种间接方式来表达敌意，让人感到困惑和沮丧。</p>
                    </div>
                </div>
            `
        },
        narcissist: {
            title: '自恋型邀功者',
            content: `
                <div class="space-y-4">
                    <p><strong class="text-blue-600">核心动机：</strong>获得持续的赞美和认可，确认自我价值。</p>
                    <div>
                        <p class="font-semibold mb-2">关键行为指标：</p>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            <li><strong>窃取功劳：</strong>将团队成果归功于自己。</li>
                            <li><strong>贬低他人：</strong>通过贬低他人来突出自己。</li>
                            <li><strong>夸大成就：</strong>过分夸大自己的贡献和能力。</li>
                            <li><strong>缺乏同理心：</strong>无法理解或关心他人的感受。</li>
                            <li><strong>需要赞美：</strong>极度渴望他人的认可和赞美。</li>
                        </ul>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <p class="text-sm"><strong>识别要点：</strong>这类人总是试图成为关注的焦点，经常夸大自己的贡献，同时贬低他人的价值。</p>
                    </div>
                </div>
            `
        }
    };

    // 模态框功能
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');
    const modalClose = document.getElementById('modal-close');
    const modalCards = document.querySelectorAll('[data-modal]');

    modalCards.forEach(card => {
        card.addEventListener('click', function() {
            const modalType = this.dataset.modal;
            const data = modalData[modalType];
            
            modalTitle.textContent = data.title;
            modalBody.innerHTML = data.content;
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        });
    });

    modalClose.addEventListener('click', function() {
        modal.classList.add('hidden');
        document.body.style.overflow = 'auto';
    });

    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto';
        }
    });

    // 标签页功能
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');

    tabButtons.forEach(button => {
        button.addEventListener('click', function() {
            const tabId = this.dataset.tab;

            // 更新按钮状态
            tabButtons.forEach(btn => btn.classList.remove('active', 'bg-apple-blue', 'text-white'));
            this.classList.add('active', 'bg-apple-blue', 'text-white');

            // 更新内容显示
            tabContents.forEach(content => {
                if (content.id === tabId) {
                    content.classList.remove('hidden');
                } else {
                    content.classList.add('hidden');
                }
            });
        });
    });

    // 手风琴功能
    const accordionHeaders = document.querySelectorAll('.accordion-header');
    accordionHeaders.forEach(header => {
        header.addEventListener('click', function() {
            const content = this.nextElementSibling;
            const icon = this.querySelector('span:last-child');
            
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
                icon.textContent = '+';
                content.classList.remove('border-t');
            } else {
                // 关闭其他手风琴
                document.querySelectorAll('.accordion-content').forEach(c => {
                    c.style.maxHeight = null;
                    c.classList.remove('border-t');
                });
                document.querySelectorAll('.accordion-header span:last-child').forEach(i => i.textContent = '+');
                
                content.style.maxHeight = content.scrollHeight + "px";
                icon.textContent = '-';
                content.classList.add('border-t');
            }
        });
    });

    // 导航滚动监听
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('.nav-section-link');

    function updateActiveNav() {
        let current = '';
        sections.forEach(section => {
            const sectionTop = section.offsetTop - 100;
            if (window.pageYOffset >= sectionTop) {
                current = section.getAttribute('id');
            }
        });

        navLinks.forEach(link => {
            link.classList.remove('bg-apple-blue', 'text-white');
            if (link.getAttribute('href').includes(current)) {
                link.classList.add('bg-apple-blue', 'text-white');
            }
        });
    }

    window.addEventListener('scroll', updateActiveNav);
    updateActiveNav(); // 初始化

    // 平滑滚动
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Chart.js 图表
    const ctx = document.getElementById('impactChart');
    if (ctx) {
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['毒性员工', '普通员工', '明星员工'],
                datasets: [{
                    label: '年度成本/价值 (千美元)',
                    data: [-160, 80, 240],
                    backgroundColor: [
                        'rgba(239, 68, 68, 0.8)',
                        'rgba(156, 163, 175, 0.8)',
                        'rgba(34, 197, 94, 0.8)'
                    ],
                    borderColor: [
                        'rgba(239, 68, 68, 1)',
                        'rgba(156, 163, 175, 1)',
                        'rgba(34, 197, 94, 1)'
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const value = Math.abs(context.parsed.y);
                                const type = context.parsed.y < 0 ? '成本' : '价值';
                                return `${type}: $${value},000`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '$' + Math.abs(value) + 'k';
                            }
                        }
                    }
                }
            }
        });
    }
});
</script>

<!-- 时间线样式 -->
<style>
.jaw-timeline {
    position: relative;
    padding: 2rem 0;
}

.jaw-timeline::before {
    content: '';
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 3px;
    height: 100%;
    background-color: #E5E7EB;
}

.timeline-item {
    position: relative;
    width: 50%;
    padding: 1rem 2rem;
    margin-bottom: 2rem;
}

.timeline-item:nth-child(odd) {
    left: 0;
    padding-right: 4rem;
}

.timeline-item:nth-child(even) {
    left: 50%;
    padding-left: 4rem;
}

.timeline-dot {
    position: absolute;
    top: 1.5rem;
    width: 1.25rem;
    height: 1.25rem;
    border-radius: 50%;
    background-color: #fff;
    border: 3px solid #007AFF;
    z-index: 10;
}

.timeline-item:nth-child(odd) .timeline-dot {
    right: -0.625rem;
}

.timeline-item:nth-child(even) .timeline-dot {
    left: -0.625rem;
}

.timeline-content {
    transition: all 0.3s ease;
}

.timeline-content:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

@media (max-width: 768px) {
    .jaw-timeline::before {
        left: 1rem;
    }
    
    .timeline-item {
        width: 100%;
        left: 0 !important;
        padding-left: 3rem !important;
        padding-right: 1rem !important;
    }
    
    .timeline-dot {
        left: 0.375rem !important;
        right: auto !important;
    }
}
</style>
